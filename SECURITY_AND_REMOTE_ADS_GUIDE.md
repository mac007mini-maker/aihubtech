# üîê B·∫£o M·∫≠t Secrets & Remote Control Ads Guide

## ‚ö†Ô∏è S·ª∞ TH·∫¨T V·ªÄ B·∫¢O M·∫¨T API KEYS TRONG APP

### üö® **C√ÇU TR·∫¢ L·ªúI NG·∫ÆN G·ªåN:**

**C√ì, secrets trong `prod.json` v·∫´n c√≥ th·ªÉ b·ªã extract ra ƒë∆∞·ª£c ngay c·∫£ khi d√πng `--dart-define` v√† `--obfuscate`!**

---

## üì± PH·∫¶N 1: B·∫¢O M·∫¨T SECRETS - S·ª∞ TH·∫¨T C·∫¶N BI·∫æT

### ‚ùå **Nh·ªØng G√¨ KH√îNG An To√†n:**

#### 1. **--dart-define KH√îNG b·∫£o m·∫≠t 100%**
```bash
# D√π build v·ªõi obfuscate...
flutter build appbundle --obfuscate --dart-define-from-file=prod.json

# Hacker v·∫´n extract ƒë∆∞·ª£c b·∫±ng:
apktool d app-release.apk
strings lib/arm64-v8a/libapp.so | grep -i "api\|token\|key"
```

**K·∫øt qu·∫£:** API keys c·ªßa anh s·∫Ω hi·ªán ra nh∆∞ n√†y:
```
hf_abcdefghijklmnopqrstuvwxyz12345
r8_zyxwvutsrqponmlkjihgfedcba54321
eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
```

#### 2. **Obfuscation ch·ªâ l√† "che m·ªù", kh√¥ng ph·∫£i "m√£ h√≥a"**
- `--obfuscate` ch·ªâ rename class/function names
- String literals (API keys) v·∫´n nguy√™n vƒÉn trong binary
- Tools nh∆∞ `reFlutter`, `darter` d·ªÖ d√†ng extract

#### 3. **Debug APK nguy hi·ªÉm H∆†N N·ªÆA**
- File `kernel_blob.bin` ch·ª©a source code nguy√™n b·∫£n (k·ªÉ c·∫£ comments!)
- Extract b·∫±ng: `strings kernel_blob.bin > code.dart`

---

### ‚úÖ **Gi·∫¢I PH√ÅP AN TO√ÄN:**

## üîë **Ph√¢n Lo·∫°i Secrets:**

### **1. Ad Unit IDs (AdMob, AppLovin) - KH√îNG NGUY HI·ªÇM**
```json
{
  "ADMOB_APP_ID_ANDROID": "ca-app-pub-XXXXXXXX~XXXXXXXXXX",
  "ADMOB_REWARDED_AD_UNIT_ID": "ca-app-pub-XXXXXXXX/XXXXXXXXXX",
  "APPLOVIN_SDK_KEY": "xxxxxxxxxxxxxxxxxxxxxxx"
}
```

**‚úÖ AN TO√ÄN ƒë·ªÉ embed trong app:**
- Ad IDs ƒë∆∞·ª£c **design ƒë·ªÉ public** (ph·∫£i khai b√°o trong AndroidManifest.xml/Info.plist)
- Hacker bi·∫øt c≈©ng kh√¥ng l√†m g√¨ ƒë∆∞·ª£c (kh√¥ng charge ti·ªÅn anh)
- Ch·ªâ ho·∫°t ƒë·ªông v·ªõi package name/bundle ID c·ªßa app anh

### **2. API Tokens (Replicate, Huggingface) - NGUY HI·ªÇM!!!**
```json
{
  "REPLICATE_API_TOKEN": "r8_xxxxx",  // ‚ùå NGUY HI·ªÇM
  "HUGGINGFACE_TOKEN": "hf_xxxxx"     // ‚ùå NGUY HI·ªÇM
}
```

**‚ùå KH√îNG AN TO√ÄN v√¨:**
- Hacker extract ƒë∆∞·ª£c ‚Üí D√πng API v·ªõi token c·ªßa anh
- Replicate charge **$0.0019/l·∫ßn** ‚Üí Hacker ch·∫°y 10,000 l·∫ßn = **$19**
- Huggingface Pro **$9/th√°ng** ‚Üí Hacker d√πng mi·ªÖn ph√≠

---

## üõ°Ô∏è **GI·∫¢I PH√ÅP B·∫¢O M·∫¨T CHO PRODUCTION:**

### **Option 1: Backend Proxy (KHUY·∫æN NGH·ªä)**

**Architecture:**
```
Flutter App            Backend Server           AI Services
   ‚îÇ                        ‚îÇ                        ‚îÇ
   ‚îÇ  1. Request HD photo   ‚îÇ                        ‚îÇ
   ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ>‚îÇ                        ‚îÇ
   ‚îÇ                        ‚îÇ  2. Call Replicate    ‚îÇ
   ‚îÇ                        ‚îÇ   (with server token)  ‚îÇ
   ‚îÇ                        ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ>‚îÇ
   ‚îÇ                        ‚îÇ<‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÇ
   ‚îÇ  3. Return result      ‚îÇ                        ‚îÇ
   ‚îÇ<‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÇ                        ‚îÇ
```

**Implementation:**

**Backend (Python Flask - ƒê√£ c√≥ `api_server.py`):**
```python
# api_server.py (ƒë√£ c√≥ s·∫µn)
@app.route('/api/ai/hd-image', methods=['POST'])
def handle_hd_image():
    # Token stored on SERVER, not in app
    REPLICATE_TOKEN = os.getenv('REPLICATE_API_TOKEN')
    
    # Process request
    image_data = request.json['image']
    result = replicate_api.upscale(image_data, token=REPLICATE_TOKEN)
    
    return jsonify(result)
```

**Flutter (Kh√¥ng c·∫ßn Replicate token):**
```dart
// Ch·ªâ c·∫ßn g·ªçi backend
final response = await http.post(
  Uri.parse('https://your-backend.com/api/ai/hd-image'),
  body: jsonEncode({'image': base64Image}),
);
```

**‚úÖ ∆Øu ƒëi·ªÉm:**
- Token KH√îNG bao gi·ªù c√≥ trong app
- Hacker decompile c≈©ng v√¥ √≠ch
- Control ƒë∆∞·ª£c rate limiting, usage tracking

---

### **Option 2: Supabase Edge Functions (Alternative)**

```typescript
// Supabase Edge Function
import { serve } from "https://deno.land/std/http/server.ts";

serve(async (req) => {
  const { image } = await req.json();
  
  // Token stored in Supabase secrets
  const REPLICATE_TOKEN = Deno.env.get("REPLICATE_API_TOKEN");
  
  const response = await fetch("https://api.replicate.com/v1/predictions", {
    headers: { Authorization: `Token ${REPLICATE_TOKEN}` },
    body: JSON.stringify({ input: { image } })
  });
  
  return new Response(await response.text());
});
```

---

## üì± PH·∫¶N 2: REMOTE CONTROL ADS (B·∫¨T/T·∫ÆT T·ª™ XA)

### ‚úÖ **C√ÇU TR·∫¢ L·ªúI: HO√ÄN TO√ÄN H·ª¢P L·ªÜ!**

**Google AdMob ch√≠nh th·ª©c h·ªó tr·ª£ v√† KHUY·∫æN KH√çCH d√πng Firebase Remote Config ƒë·ªÉ control ads!**

---

## üî• **Firebase Remote Config Solution (KHUY·∫æN NGH·ªä)**

### **T·∫°i Sao D√πng Firebase Remote Config?**

‚úÖ **Policy-compliant**: Google c√≥ tutorial ch√≠nh th·ª©c v·ªÅ vi·ªác n√†y  
‚úÖ **Real-time updates**: Thay ƒë·ªïi ngay l·∫≠p t·ª©c, kh√¥ng c·∫ßn update app  
‚úÖ **Free tier**: 2,000 active users mi·ªÖn ph√≠  
‚úÖ **A/B testing**: Test revenue v·ªõi/kh√¥ng ads  
‚úÖ **Targeting**: B·∫≠t ads theo country, version, user segment  

**‚ö†Ô∏è Use Case C·ªßa Anh:**
- L√∫c ƒë·∫ßu: `show_ads = false` ‚Üí 0-5k users kh√¥ng th·∫•y ads
- Sau ƒë√≥: `show_ads = true` ‚Üí 5k-10k users b·∫Øt ƒë·∫ßu th·∫•y ads
- Premium users: `show_ads = false` ‚Üí Paid users kh√¥ng ads

---

### **üöÄ Implementation Chi Ti·∫øt:**

#### **B∆∞·ªõc 1: Setup Firebase (N·∫øu ch∆∞a c√≥)**

```bash
# Add Firebase dependencies
flutter pub add firebase_core
flutter pub add firebase_remote_config
flutter pub add firebase_analytics  # C·∫ßn cho targeting
```

**Setup Firebase:**
1. V√†o [Firebase Console](https://console.firebase.google.com)
2. Create project ho·∫∑c d√πng project hi·ªán t·∫°i
3. Add Android app (package: `com.visoai.photoheadshot`)
4. Add iOS app (bundle: `com.visoai.photoheadshot`)
5. Download `google-services.json` (Android) v√† `GoogleService-Info.plist` (iOS)

#### **B∆∞·ªõc 2: Create Remote Config Parameters**

**Firebase Console ‚Üí Engage ‚Üí Remote Config:**

T·∫°o c√°c parameters:
```json
{
  "ads_enabled": true,              // B·∫≠t/t·∫Øt to√†n b·ªô ads
  "banner_ads_enabled": true,       // B·∫≠t/t·∫Øt banner ads
  "rewarded_ads_enabled": true,     // B·∫≠t/t·∫Øt rewarded ads
  "interstitial_ads_enabled": true, // B·∫≠t/t·∫Øt interstitial ads
  "min_user_count_for_ads": 5000    // Ch·ªâ show ads khi ‚â• 5k users
}
```

**Add Conditions (Optional):**
- Country: `ads_enabled = false` cho Vietnam (marketing phase)
- User Property: `ads_enabled = false` cho premium users
- App Version: `ads_enabled = true` ch·ªâ t·ª´ version 1.2.0+

#### **B∆∞·ªõc 3: Flutter Code Implementation**

**Create `lib/services/remote_config_service.dart`:**

```dart
import 'package:firebase_remote_config/firebase_remote_config.dart';

class RemoteConfigService {
  static final RemoteConfigService _instance = RemoteConfigService._internal();
  factory RemoteConfigService() => _instance;
  RemoteConfigService._internal();

  final FirebaseRemoteConfig _remoteConfig = FirebaseRemoteConfig.instance;

  // Ad control flags
  bool get adsEnabled => _remoteConfig.getBool('ads_enabled');
  bool get bannerAdsEnabled => _remoteConfig.getBool('banner_ads_enabled');
  bool get rewardedAdsEnabled => _remoteConfig.getBool('rewarded_ads_enabled');
  bool get interstitialAdsEnabled => _remoteConfig.getBool('interstitial_ads_enabled');
  int get minUserCountForAds => _remoteConfig.getInt('min_user_count_for_ads');

  Future<void> initialize() async {
    try {
      // Set defaults (khi offline ho·∫∑c fetch fail)
      await _remoteConfig.setDefaults({
        'ads_enabled': false,  // Default: KH√îNG show ads (an to√†n)
        'banner_ads_enabled': false,
        'rewarded_ads_enabled': false,
        'interstitial_ads_enabled': false,
        'min_user_count_for_ads': 5000,
      });

      // Config settings
      await _remoteConfig.setConfigSettings(RemoteConfigSettings(
        fetchTimeout: const Duration(minutes: 1),
        minimumFetchInterval: const Duration(hours: 1), // Production: 12 hours
      ));

      // Fetch and activate
      await _remoteConfig.fetchAndActivate();
      
      print('‚úÖ Remote Config initialized');
      print('Ads enabled: $adsEnabled');
    } catch (e) {
      print('‚ùå Remote Config error: $e');
      // Fallback to defaults
    }
  }

  // Refresh config (g·ªçi khi app resume t·ª´ background)
  Future<void> refresh() async {
    await _remoteConfig.fetchAndActivate();
  }
}
```

**Update `main.dart`:**

```dart
import 'package:firebase_core/firebase_core.dart';
import 'firebase_options.dart';

void main() async {
  WidgetsFlutterBinding.ensureInitialized();
  
  // Initialize Firebase
  await Firebase.initializeApp(
    options: DefaultFirebaseOptions.currentPlatform,
  );
  
  // Initialize Remote Config
  await RemoteConfigService().initialize();
  
  // Initialize ads ONLY if enabled
  if (RemoteConfigService().adsEnabled) {
    await initializeAds();  // H√†m init AdMob/AppLovin
  }
  
  runApp(MyApp());
}
```

**Update Ad Widgets:**

```dart
// lib/components/bottom_navigation_with_ad.dart
Widget build(BuildContext context) {
  final remoteConfig = RemoteConfigService();
  
  return Column(
    children: [
      // Show ad banner ONLY if enabled
      if (remoteConfig.adsEnabled && remoteConfig.bannerAdsEnabled)
        Container(
          height: 50,
          color: Colors.black,
          child: AdWidget(ad: bannerAd),
        )
      else
        SizedBox.shrink(), // Kh√¥ng show g√¨
      
      // Bottom navigation
      BottomNavigationBar(...),
    ],
  );
}
```

**Rewarded Ads:**

```dart
void showRewardedAd() {
  final remoteConfig = RemoteConfigService();
  
  // Check remote config tr∆∞·ªõc
  if (!remoteConfig.adsEnabled || !remoteConfig.rewardedAdsEnabled) {
    // Kh√¥ng c√≥ ads ‚Üí cho user d√πng feature lu√¥n
    proceedWithFeature();
    return;
  }
  
  // Show rewarded ad
  rewardedAd?.show(
    onUserEarnedReward: (ad, reward) {
      proceedWithFeature();
    },
  );
}
```

---

## üéØ **Use Case Th·ª±c T·∫ø C·ªßa Anh:**

### **Giai ƒêo·∫°n 1: Marketing (0-5k users)**

**Firebase Console:**
```json
{
  "ads_enabled": false,
  "min_user_count_for_ads": 5000
}
```

**K·∫øt qu·∫£:**
- ‚úÖ User download app ‚Üí Kh√¥ng th·∫•y ads
- ‚úÖ Tr·∫£i nghi·ªám m∆∞·ª£t m√† ‚Üí Retention cao
- ‚úÖ Word-of-mouth marketing t·ªët

### **Giai ƒêo·∫°n 2: Monetization (5k-10k users)**

**Firebase Console (ch·ªâ c·∫ßn click toggle):**
```json
{
  "ads_enabled": true,  // ‚Üê Ch·ªâ c·∫ßn ƒë·ªïi true
  "banner_ads_enabled": true,
  "rewarded_ads_enabled": true
}
```

**K·∫øt qu·∫£:**
- ‚úÖ Ads b·∫≠t ngay l·∫≠p t·ª©c (kh√¥ng c·∫ßn update app)
- ‚úÖ User hi·ªán t·∫°i: B·∫Øt ƒë·∫ßu th·∫•y ads
- ‚úÖ User m·ªõi: Th·∫•y ads ngay t·ª´ ƒë·∫ßu

### **Giai ƒêo·∫°n 3: Premium Users**

**Add condition targeting:**
- User Property: `is_premium = true`
- Parameter value: `ads_enabled = false`

**Ho·∫∑c d√πng code:**
```dart
bool shouldShowAds() {
  final remoteConfig = RemoteConfigService();
  final userService = UserService();
  
  // Premium users: KH√îNG ads
  if (userService.isPremiumUser) return false;
  
  // Check remote config
  return remoteConfig.adsEnabled;
}
```

---

## üìä **Alternative: Supabase Remote Config (N·∫øu kh√¥ng mu·ªën d√πng Firebase)**

### **Setup Table:**

```sql
CREATE TABLE app_config (
  id INT PRIMARY KEY,
  ads_enabled BOOLEAN DEFAULT false,
  banner_ads_enabled BOOLEAN DEFAULT false,
  rewarded_ads_enabled BOOLEAN DEFAULT false,
  min_user_count INT DEFAULT 5000,
  updated_at TIMESTAMP DEFAULT NOW()
);

INSERT INTO app_config (id, ads_enabled) VALUES (1, false);
```

### **Flutter Code:**

```dart
class SupabaseRemoteConfig {
  Future<Map<String, dynamic>> fetchConfig() async {
    final response = await Supabase.instance.client
        .from('app_config')
        .select()
        .eq('id', 1)
        .single();
    
    return response.data;
  }
  
  bool get adsEnabled => _config['ads_enabled'] ?? false;
}
```

**‚úÖ ∆Øu ƒëi·ªÉm Supabase:**
- ƒê√£ c√≥ s·∫µn Supabase trong project
- Kh√¥ng c·∫ßn th√™m dependency
- Control ƒë·∫ßy ƒë·ªß qua SQL

**‚ùå Nh∆∞·ª£c ƒëi·ªÉm:**
- Kh√¥ng c√≥ A/B testing t·ª± ƒë·ªông
- Kh√¥ng c√≥ targeting theo country/version
- Ph·∫£i t·ª± implement caching

---

## ‚öñÔ∏è **POLICY COMPLIANCE - C√ì VI PH·∫†M KH√îNG?**

### ‚úÖ **C√ÇU TR·∫¢ L·ªúI: HO√ÄN TO√ÄN H·ª¢P L·ªÜ!**

#### **Google Play Policy:**
- ‚úÖ **Allowed**: B·∫≠t/t·∫Øt ads qua code logic
- ‚úÖ **Allowed**: Kh√¥ng show ads cho premium users
- ‚úÖ **Allowed**: A/B testing ad frequency
- ‚ùå **Not Allowed**: Click fraud, fake impressions, hidden ads

#### **AdMob Policy:**
- ‚úÖ **Allowed**: Remote Config control (c√≥ tutorial ch√≠nh th·ª©c)
- ‚úÖ **Allowed**: Conditional ad display
- ‚úÖ **Allowed**: User-triggered ad removal (premium purchase)
- ‚ùå **Not Allowed**: Manipulate eCPM floors ƒë·ªÉ "t·∫Øt" ads

#### **App Store Policy:**
- ‚úÖ **Allowed**: Dynamic ad control
- ‚úÖ **Allowed**: In-app purchase ƒë·ªÉ remove ads
- ‚úÖ **Allowed**: Regional ad restrictions
- ‚ùå **Not Allowed**: Hidden tracking, deceptive practices

**üìö Official Google Tutorial:**
- [Firebase Remote Config + AdMob](https://firebase.google.com/docs/tutorials/optimize-ad-frequency)
- Case study: MegaJogos tƒÉng 300% revenue b·∫±ng Remote Config

---

## üèóÔ∏è **KI·∫æN TR√öC PRODUCTION KHUY·∫æN NGH·ªä:**

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ              Flutter App                        ‚îÇ
‚îÇ                                                 ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ
‚îÇ  ‚îÇ  Remote Config Service                   ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ  - ads_enabled: bool                     ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ  - banner_ads_enabled: bool              ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ  - rewarded_ads_enabled: bool            ‚îÇ  ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ
‚îÇ                                                 ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ
‚îÇ  ‚îÇ  Ad Manager                              ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ  - Check remote config tr∆∞·ªõc khi show    ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ  - Fallback khi offline                  ‚îÇ  ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ
‚îÇ                                                 ‚îÇ
‚îÇ  üì± Ad Unit IDs (trong prod.json - OK)         ‚îÇ
‚îÇ  - ADMOB_APP_ID: ca-app-pub-xxx~xxx            ‚îÇ
‚îÇ  - APPLOVIN_SDK_KEY: xxx                       ‚îÇ
‚îÇ                                                 ‚îÇ
‚îÇ  ‚ùå KH√îNG c√≥ Replicate/Huggingface tokens      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                      ‚ñ≤
                      ‚îÇ Fetch config
                      ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ         Firebase Remote Config                  ‚îÇ
‚îÇ         (ho·∫∑c Supabase app_config table)        ‚îÇ
‚îÇ                                                 ‚îÇ
‚îÇ  {                                              ‚îÇ
‚îÇ    "ads_enabled": true/false,                   ‚îÇ
‚îÇ    "banner_ads_enabled": true/false,            ‚îÇ
‚îÇ    "rewarded_ads_enabled": true/false           ‚îÇ
‚îÇ  }                                              ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ         Backend Server (api_server.py)          ‚îÇ
‚îÇ                                                 ‚îÇ
‚îÇ  üîê Replicate API Token (server-side)          ‚îÇ
‚îÇ  üîê Huggingface API Token (server-side)        ‚îÇ
‚îÇ                                                 ‚îÇ
‚îÇ  Endpoints:                                     ‚îÇ
‚îÇ  - POST /api/ai/hd-image                        ‚îÇ
‚îÇ  - POST /api/ai/face-swap                       ‚îÇ
‚îÇ  - POST /api/ai/fix-old-photo                   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## ‚úÖ **CHECKLIST PRODUCTION:**

### **Secrets Management:**
- [ ] Ad Unit IDs trong `prod.json` (OK, kh√¥ng nguy hi·ªÉm)
- [ ] Replicate/Huggingface tokens KH√îNG c√≥ trong app
- [ ] Backend proxy cho AI API calls
- [ ] Supabase credentials trong app (OK, c√≥ RLS policies)

### **Remote Ads Control:**
- [ ] Firebase Remote Config setup
- [ ] Default values: `ads_enabled = false` (an to√†n)
- [ ] Ad widgets check remote config tr∆∞·ªõc khi show
- [ ] Fallback khi offline/fetch fail
- [ ] Targeting conditions (premium users, countries, versions)

### **Policy Compliance:**
- [ ] Kh√¥ng manipulate ad auction
- [ ] Kh√¥ng fake impressions/clicks
- [ ] Privacy policy mention ad control
- [ ] GDPR consent tr∆∞·ªõc khi show ads

---

## üéØ **T√ìM T·∫ÆT - NH·ªÆNG G√å ANH C·∫¶N L√ÄM:**

### **1. B·∫£o M·∫≠t Secrets:**

**‚úÖ AN TO√ÄN ƒë·ªÉ trong prod.json:**
```json
{
  "ADMOB_APP_ID_ANDROID": "...",
  "ADMOB_REWARDED_AD_UNIT_ID": "...",
  "APPLOVIN_SDK_KEY": "...",
  "SUPABASE_URL": "...",
  "SUPABASE_ANON_KEY": "...",
  "SUPPORT_EMAIL": "..."
}
```

**‚ùå DI CHUY·ªÇN RA BACKEND:**
```json
{
  "REPLICATE_API_TOKEN": "...",  // ‚Üê Move to backend
  "HUGGINGFACE_TOKEN": "..."     // ‚Üê Move to backend
}
```

### **2. Remote Ads Control:**

**Option A: Firebase Remote Config (KHUY·∫æN NGH·ªä)**
```bash
flutter pub add firebase_core firebase_remote_config
# Setup nh∆∞ h∆∞·ªõng d·∫´n tr√™n
```

**Option B: Supabase Config Table**
```sql
CREATE TABLE app_config (
  ads_enabled BOOLEAN DEFAULT false
);
```

### **3. Implementation:**
```dart
// main.dart
void main() async {
  await Firebase.initializeApp();
  await RemoteConfigService().initialize();
  
  if (RemoteConfigService().adsEnabled) {
    await initializeAds();
  }
  
  runApp(MyApp());
}

// Ad widgets
if (RemoteConfigService().bannerAdsEnabled) {
  showBannerAd();
}
```

---

## üìû **C√¢u H·ªèi Th∆∞·ªùng G·∫∑p:**

**Q: C√≥ c·∫ßn update app khi b·∫≠t/t·∫Øt ads kh√¥ng?**  
A: KH√îNG! Remote Config update real-time, user restart app l√† th·∫•y thay ƒë·ªïi.

**Q: N·∫øu user offline th√¨ sao?**  
A: D√πng gi√° tr·ªã default ho·∫∑c cached value l·∫ßn fetch tr∆∞·ªõc.

**Q: Chi ph√≠ Firebase Remote Config?**  
A: Free cho 2,000 active users, sau ƒë√≥ $0.01/1000 fetches.

**Q: AdMob c√≥ ban account v√¨ t·∫Øt ads kh√¥ng?**  
A: KH√îNG! ƒê√¢y l√† use case ch√≠nh th·ª©c ƒë∆∞·ª£c Google support.

---

**üéâ K·∫æT LU·∫¨N:**

1. **Ad IDs trong prod.json = OK**
2. **API Tokens ph·∫£i move ra backend**
3. **Remote Config b·∫≠t/t·∫Øt ads = HO√ÄN TO√ÄN H·ª¢P L·ªÜ**
4. **Use case c·ªßa anh = Chi·∫øn l∆∞·ª£c marketing th√¥ng minh**

C√≥ g√¨ th·∫Øc m·∫Øc th√™m c·ª© h·ªèi em nh√© anh! üöÄ
